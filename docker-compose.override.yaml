# =============================================================================
# Docker Compose Override - Development Settings
# =============================================================================
#
# This file is automatically loaded by docker-compose and overrides the
# base docker-compose.yaml settings for local development.
#
# Usage:
#   docker-compose up -d                    # Uses both files
#   docker-compose -f docker-compose.yaml up -d   # Production only
#
# =============================================================================

version: '3.8'

services:
  # Main Trading Application - Development overrides
  alphatrade:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - DEV_MODE=true
    environment:
      - LOG_LEVEL=DEBUG
      - TRADING_MODE=paper
      - DEBUG=1
    volumes:
      # Mount source for hot-reload during development
      - ./src:/app/src
      - ./main.py:/app/main.py
      - ./scripts:/app/scripts
    # Enable interactive mode for debugging
    stdin_open: true
    tty: true

  # PostgreSQL - Development settings
  postgres:
    ports:
      - "5432:5432"  # Expose to host for local tools
    environment:
      - POSTGRES_PASSWORD=trading123

  # Redis - Development settings
  redis:
    ports:
      - "6379:6379"  # Expose to host for local access

  # Grafana - Development settings
  grafana:
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
      - GF_AUTH_ANONYMOUS_ENABLED=true
      - GF_AUTH_ANONYMOUS_ORG_ROLE=Viewer

  # Prometheus - Development settings
  prometheus:
    ports:
      - "9090:9090"

  # Jupyter - Already configured for development
  jupyter:
    environment:
      - JUPYTER_TOKEN=dev
    ports:
      - "8888:8888"
